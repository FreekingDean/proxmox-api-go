// File generated by proxmox json schema, DO NOT EDIT

package rules

import (
	"context"
)

type HTTPClient interface {
	Do(context.Context, string, string, interface{}, interface{}) error
}

type Client struct {
	httpClient HTTPClient
}

func New(c HTTPClient) *Client {
	return &Client{
		httpClient: c,
	}
}

type IndexRequest struct {
	Node string `url:"node",json:"node"`
}

type IndexResponse []*struct {
	Pos int `url:"pos",json:"pos"`
}

// Index List rules.
func (c *Client) Index(ctx context.Context, req *IndexRequest) (*IndexResponse, error) {
	var resp *IndexResponse

	err := c.httpClient.Do(ctx, "/nodes/{node}/firewall/rules", "GET", &resp, req)
	return resp, err
}

type CreateRequest struct {
	Source   *string `url:"source,omitempty",json:"source,omitempty"`
	Type     string  `url:"type",json:"type"`
	Digest   *string `url:"digest,omitempty",json:"digest,omitempty"`
	Enable   *int    `url:"enable,omitempty",json:"enable,omitempty"`
	Node     string  `url:"node",json:"node"`
	Pos      *int    `url:"pos,omitempty",json:"pos,omitempty"`
	Action   string  `url:"action",json:"action"`
	Dest     *string `url:"dest,omitempty",json:"dest,omitempty"`
	Macro    *string `url:"macro,omitempty",json:"macro,omitempty"`
	Comment  *string `url:"comment,omitempty",json:"comment,omitempty"`
	Dport    *string `url:"dport,omitempty",json:"dport,omitempty"`
	IcmpType *string `url:"icmp-type,omitempty",json:"icmp-type,omitempty"`
	Iface    *string `url:"iface,omitempty",json:"iface,omitempty"`
	Log      *string `url:"log,omitempty",json:"log,omitempty"`
	Proto    *string `url:"proto,omitempty",json:"proto,omitempty"`
	Sport    *string `url:"sport,omitempty",json:"sport,omitempty"`
}

type CreateResponse map[string]interface{}

// Create Create new rule.
func (c *Client) Create(ctx context.Context, req *CreateRequest) (*CreateResponse, error) {
	var resp *CreateResponse

	err := c.httpClient.Do(ctx, "/nodes/{node}/firewall/rules", "POST", &resp, req)
	return resp, err
}

type FindRequest struct {
	Node string `url:"node",json:"node"`
	Pos  *int   `url:"pos,omitempty",json:"pos,omitempty"`
}

type FindResponse struct {
	Pos       int     `url:"pos",json:"pos"`
	Enable    *int    `url:"enable,omitempty",json:"enable,omitempty"`
	Sport     *string `url:"sport,omitempty",json:"sport,omitempty"`
	Type      string  `url:"type",json:"type"`
	Comment   *string `url:"comment,omitempty",json:"comment,omitempty"`
	IcmpType  *string `url:"icmp-type,omitempty",json:"icmp-type,omitempty"`
	Iface     *string `url:"iface,omitempty",json:"iface,omitempty"`
	Ipversion *int    `url:"ipversion,omitempty",json:"ipversion,omitempty"`
	Log       *string `url:"log,omitempty",json:"log,omitempty"`
	Proto     *string `url:"proto,omitempty",json:"proto,omitempty"`
	Source    *string `url:"source,omitempty",json:"source,omitempty"`
	Dport     *string `url:"dport,omitempty",json:"dport,omitempty"`
	Dest      *string `url:"dest,omitempty",json:"dest,omitempty"`
	Macro     *string `url:"macro,omitempty",json:"macro,omitempty"`
	Action    string  `url:"action",json:"action"`
}

// Find Get single rule data.
func (c *Client) Find(ctx context.Context, req *FindRequest) (*FindResponse, error) {
	var resp *FindResponse

	err := c.httpClient.Do(ctx, "/nodes/{node}/firewall/rules/{pos}", "GET", &resp, req)
	return resp, err
}

type UpdateRequest struct {
	Type     *string `url:"type,omitempty",json:"type,omitempty"`
	Delete   *string `url:"delete,omitempty",json:"delete,omitempty"`
	Dest     *string `url:"dest,omitempty",json:"dest,omitempty"`
	Moveto   *int    `url:"moveto,omitempty",json:"moveto,omitempty"`
	Sport    *string `url:"sport,omitempty",json:"sport,omitempty"`
	Enable   *int    `url:"enable,omitempty",json:"enable,omitempty"`
	Iface    *string `url:"iface,omitempty",json:"iface,omitempty"`
	Source   *string `url:"source,omitempty",json:"source,omitempty"`
	Dport    *string `url:"dport,omitempty",json:"dport,omitempty"`
	Log      *string `url:"log,omitempty",json:"log,omitempty"`
	Pos      *int    `url:"pos,omitempty",json:"pos,omitempty"`
	IcmpType *string `url:"icmp-type,omitempty",json:"icmp-type,omitempty"`
	Macro    *string `url:"macro,omitempty",json:"macro,omitempty"`
	Node     string  `url:"node",json:"node"`
	Proto    *string `url:"proto,omitempty",json:"proto,omitempty"`
	Action   *string `url:"action,omitempty",json:"action,omitempty"`
	Comment  *string `url:"comment,omitempty",json:"comment,omitempty"`
	Digest   *string `url:"digest,omitempty",json:"digest,omitempty"`
}

type UpdateResponse map[string]interface{}

// Update Modify rule data.
func (c *Client) Update(ctx context.Context, req *UpdateRequest) (*UpdateResponse, error) {
	var resp *UpdateResponse

	err := c.httpClient.Do(ctx, "/nodes/{node}/firewall/rules/{pos}", "PUT", &resp, req)
	return resp, err
}

type DeleteRequest struct {
	Digest *string `url:"digest,omitempty",json:"digest,omitempty"`
	Node   string  `url:"node",json:"node"`
	Pos    *int    `url:"pos,omitempty",json:"pos,omitempty"`
}

type DeleteResponse map[string]interface{}

// Delete Delete rule.
func (c *Client) Delete(ctx context.Context, req *DeleteRequest) (*DeleteResponse, error) {
	var resp *DeleteResponse

	err := c.httpClient.Do(ctx, "/nodes/{node}/firewall/rules/{pos}", "DELETE", &resp, req)
	return resp, err
}
