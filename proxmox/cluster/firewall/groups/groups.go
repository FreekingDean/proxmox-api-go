// File generated by proxmox json schema, DO NOT EDIT

package groups

import (
	"context"
)

type HTTPClient interface {
	Do(context.Context, string, string, interface{}, interface{}) error
}

type Client struct {
	httpClient HTTPClient
}

func New(c HTTPClient) *Client {
	return &Client{
		httpClient: c,
	}
}

type IndexResponse []*struct {
	Comment *string `url:"comment,omitempty",json:"comment,omitempty"`
	Digest  string  `url:"digest",json:"digest"`
	Group   string  `url:"group",json:"group"`
}

// Index List security groups.
func (c *Client) Index(ctx context.Context) (*IndexResponse, error) {
	var resp *IndexResponse

	err := c.httpClient.Do(ctx, "/cluster/firewall/groups", "GET", &resp, nil)
	return resp, err
}

type CreateRequest struct {
	Digest  *string `url:"digest,omitempty",json:"digest,omitempty"`
	Group   string  `url:"group",json:"group"`
	Rename  *string `url:"rename,omitempty",json:"rename,omitempty"`
	Comment *string `url:"comment,omitempty",json:"comment,omitempty"`
}

type CreateResponse map[string]interface{}

// Create Create new security group.
func (c *Client) Create(ctx context.Context, req *CreateRequest) (*CreateResponse, error) {
	var resp *CreateResponse

	err := c.httpClient.Do(ctx, "/cluster/firewall/groups", "POST", &resp, req)
	return resp, err
}

type FindRequest struct {
	Group string `url:"group",json:"group"`
}

type FindResponse []*struct {
	Pos int `url:"pos",json:"pos"`
}

// Find List rules.
func (c *Client) Find(ctx context.Context, req *FindRequest) (*FindResponse, error) {
	var resp *FindResponse

	err := c.httpClient.Do(ctx, "/cluster/firewall/groups/{group}", "GET", &resp, req)
	return resp, err
}

type ChildCreateRequest struct {
	Pos      *int    `url:"pos,omitempty",json:"pos,omitempty"`
	Type     string  `url:"type",json:"type"`
	Enable   *int    `url:"enable,omitempty",json:"enable,omitempty"`
	Log      *string `url:"log,omitempty",json:"log,omitempty"`
	Macro    *string `url:"macro,omitempty",json:"macro,omitempty"`
	Comment  *string `url:"comment,omitempty",json:"comment,omitempty"`
	Dest     *string `url:"dest,omitempty",json:"dest,omitempty"`
	Proto    *string `url:"proto,omitempty",json:"proto,omitempty"`
	Source   *string `url:"source,omitempty",json:"source,omitempty"`
	Action   string  `url:"action",json:"action"`
	Group    string  `url:"group",json:"group"`
	IcmpType *string `url:"icmp-type,omitempty",json:"icmp-type,omitempty"`
	Iface    *string `url:"iface,omitempty",json:"iface,omitempty"`
	Sport    *string `url:"sport,omitempty",json:"sport,omitempty"`
	Digest   *string `url:"digest,omitempty",json:"digest,omitempty"`
	Dport    *string `url:"dport,omitempty",json:"dport,omitempty"`
}

type ChildCreateResponse map[string]interface{}

// ChildCreate Create new rule.
func (c *Client) ChildCreate(ctx context.Context, req *ChildCreateRequest) (*ChildCreateResponse, error) {
	var resp *ChildCreateResponse

	err := c.httpClient.Do(ctx, "/cluster/firewall/groups/{group}", "POST", &resp, req)
	return resp, err
}

type DeleteRequest struct {
	Group string `url:"group",json:"group"`
}

type DeleteResponse map[string]interface{}

// Delete Delete security group.
func (c *Client) Delete(ctx context.Context, req *DeleteRequest) (*DeleteResponse, error) {
	var resp *DeleteResponse

	err := c.httpClient.Do(ctx, "/cluster/firewall/groups/{group}", "DELETE", &resp, req)
	return resp, err
}

type DeleteRulePosRequest struct {
	Digest *string `url:"digest,omitempty",json:"digest,omitempty"`
	Group  string  `url:"group",json:"group"`
	Pos    *int    `url:"pos,omitempty",json:"pos,omitempty"`
}

type DeleteRulePosResponse map[string]interface{}

// DeleteRulePos Delete rule.
func (c *Client) DeleteRulePos(ctx context.Context, req *DeleteRulePosRequest) (*DeleteRulePosResponse, error) {
	var resp *DeleteRulePosResponse

	err := c.httpClient.Do(ctx, "/cluster/firewall/groups/{group}/{pos}", "DELETE", &resp, req)
	return resp, err
}

type GetRulePosRequest struct {
	Group string `url:"group",json:"group"`
	Pos   *int   `url:"pos,omitempty",json:"pos,omitempty"`
}

type GetRulePosResponse struct {
	Pos       int     `url:"pos",json:"pos"`
	Proto     *string `url:"proto,omitempty",json:"proto,omitempty"`
	Iface     *string `url:"iface,omitempty",json:"iface,omitempty"`
	Dest      *string `url:"dest,omitempty",json:"dest,omitempty"`
	Dport     *string `url:"dport,omitempty",json:"dport,omitempty"`
	Enable    *int    `url:"enable,omitempty",json:"enable,omitempty"`
	IcmpType  *string `url:"icmp-type,omitempty",json:"icmp-type,omitempty"`
	Macro     *string `url:"macro,omitempty",json:"macro,omitempty"`
	Action    string  `url:"action",json:"action"`
	Ipversion *int    `url:"ipversion,omitempty",json:"ipversion,omitempty"`
	Log       *string `url:"log,omitempty",json:"log,omitempty"`
	Source    *string `url:"source,omitempty",json:"source,omitempty"`
	Sport     *string `url:"sport,omitempty",json:"sport,omitempty"`
	Comment   *string `url:"comment,omitempty",json:"comment,omitempty"`
	Type      string  `url:"type",json:"type"`
}

// GetRulePos Get single rule data.
func (c *Client) GetRulePos(ctx context.Context, req *GetRulePosRequest) (*GetRulePosResponse, error) {
	var resp *GetRulePosResponse

	err := c.httpClient.Do(ctx, "/cluster/firewall/groups/{group}/{pos}", "GET", &resp, req)
	return resp, err
}

type UpdateRulePosRequest struct {
	Comment  *string `url:"comment,omitempty",json:"comment,omitempty"`
	IcmpType *string `url:"icmp-type,omitempty",json:"icmp-type,omitempty"`
	Dest     *string `url:"dest,omitempty",json:"dest,omitempty"`
	Macro    *string `url:"macro,omitempty",json:"macro,omitempty"`
	Moveto   *int    `url:"moveto,omitempty",json:"moveto,omitempty"`
	Proto    *string `url:"proto,omitempty",json:"proto,omitempty"`
	Source   *string `url:"source,omitempty",json:"source,omitempty"`
	Action   *string `url:"action,omitempty",json:"action,omitempty"`
	Delete   *string `url:"delete,omitempty",json:"delete,omitempty"`
	Iface    *string `url:"iface,omitempty",json:"iface,omitempty"`
	Sport    *string `url:"sport,omitempty",json:"sport,omitempty"`
	Digest   *string `url:"digest,omitempty",json:"digest,omitempty"`
	Enable   *int    `url:"enable,omitempty",json:"enable,omitempty"`
	Log      *string `url:"log,omitempty",json:"log,omitempty"`
	Pos      *int    `url:"pos,omitempty",json:"pos,omitempty"`
	Type     *string `url:"type,omitempty",json:"type,omitempty"`
	Dport    *string `url:"dport,omitempty",json:"dport,omitempty"`
	Group    string  `url:"group",json:"group"`
}

type UpdateRulePosResponse map[string]interface{}

// UpdateRulePos Modify rule data.
func (c *Client) UpdateRulePos(ctx context.Context, req *UpdateRulePosRequest) (*UpdateRulePosResponse, error) {
	var resp *UpdateRulePosResponse

	err := c.httpClient.Do(ctx, "/cluster/firewall/groups/{group}/{pos}", "PUT", &resp, req)
	return resp, err
}
